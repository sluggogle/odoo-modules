<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright Monweblocal 2020-->

<template id="template" xml:space="preserve">

    <!-- Adds a warning picto and the custom message for product not available for sale -->
    <t t-extend="website_sale_stock.product_availability">
        <t t-jquery="div:last" t-operation="after">
            <div t-if="product_type == 'product' and inventory_availability == 'not_available'" t-attf-class="availability_message_#{product_template} text-danger mt16">
                <i class="fa fa-exclamation-triangle" role="img" aria-label="Warning" title="Warning"/>
                <t t-esc="custom_message" />
            </div>
        </t>
    </t>

    <!-- In recently viewed product widget -->
    <t t-extend="website_sale.productsRecentlyViewed">
        
        <!-- Adds ribbon -->
        <t t-jquery="div.card" t-operation="append">
            <span t-if="product.website_ribbon_id"
                t-attf-class="o_ribbon {{ product.ribbon_class }}" t-raw="product.ribbon_html"/>
        </t>
        
        <!-- remove price and add to cart button when the product is not available for sale -->
        <t t-jquery="div.o_carousel_product_card_footer" t-operation="replace">
            <div class="o_carousel_product_card_footer card-footer d-flex align-items-center">
                <t t-if="product.product_type == 'product' and product.inventory_availability == 'not_available'">
                    
                    <div class="d-block font-weight-bold">SUR DEMANDE</div>
                    
                    <!-- Special TAGin3D TODO -->
                    <a role="button" class="btn btn-primary ml-auto" title="Contact" href="/contact">
                        <i class="fa fa-fw fa-envelope"/>
                    </a>
                    
                    <!-- <button type="button" role="button" class="btn btn-primary ml-auto disabled out_of_stock" title="Add to Cart">
                        <i class="fa fa-fw fa-shopping-cart"/>
                    </button> -->
                </t>
                <t t-else="">
                    <div class="d-block font-weight-bold" t-raw="product.price"/>
                    <button type="button" role="button" class="btn btn-primary js_add_cart ml-auto" title="Add to Cart">
                        <i class="fa fa-fw fa-shopping-cart"/>
                    </button>
                </t>
            </div>
        </t>
    </t>

</template>
